; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

;====================================================================
; ACTIVE PRODUCTION ENVIRONMENTS
;====================================================================
; Main application environment for the PrismaTech Gauntlet 3.0
; Used for building and deploying the full application
[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino

; Set serial port and speed
upload_port = COM7
monitor_port = COM7
monitor_speed = 115200

; Build settings
build_flags = 
    -D SERIAL_DEBUG=1
    -D MODE_POSITION_DETECT=1
    -D USE_ULTRA_BASIC_POSITION_DETECTOR=1

; Include primary application code, exclude test files
build_src_filter = +<*> -<../test/*> -<../examples/*> -<examples/*>

; Required libraries
lib_deps =
    fastled/FastLED @ ^3.5.0
    bblanchon/ArduinoJson @ ^6.19.4
    adafruit/Adafruit MPU6050 @ ^2.2.4
    adafruit/Adafruit Unified Sensor @ ^1.1.9
    adafruit/Adafruit BusIO @ ^1.14.1
    SPI
    Wire

; Future OTA settings - currently disabled
;upload_protocol = espota
;upload_flags =
;    --port=8266
;    --auth=PrismaTechGauntlet

;====================================================================
; ACTIVE TESTING ENVIRONMENTS
;====================================================================
; Idle Mode Test environment - ACTIVE
; Used for testing the Idle Mode implementation
[env:idletest]
platform = espressif32
board = esp32dev
framework = arduino
upload_port = COM7
monitor_port = COM7
monitor_speed = 115200
build_flags = 
    -D SERIAL_DEBUG=1
    -D TEST_MODE=1
    -D ENV_IDLE_TEST=1
build_src_filter = -<*> +<../examples/IdleModeTest.cpp> +<hardware/HardwareManager.cpp> +<hardware/MPU9250Interface.cpp> +<hardware/LEDInterface.cpp> +<hardware/PowerManager.cpp> +<detection/PositionDetector.cpp> +<core/Config.cpp> +<utils/DebugTools.cpp> +<core/GauntletController.cpp> +<core/SystemTypes.cpp> +<modes/IdleMode.cpp>
lib_deps = 
    fastled/FastLED @ ^3.5.0
    adafruit/Adafruit MPU6050 @ ^2.2.4
    adafruit/Adafruit Unified Sensor @ ^1.1.9
    adafruit/Adafruit BusIO @ ^1.14.1
    SPI
    Wire

; Simple Position Test environment - ACTIVE
; Used for testing the position detection with calibrated thresholds
[env:simplepostest]
platform = espressif32
board = esp32dev
framework = arduino
upload_port = COM7
monitor_port = COM7
monitor_speed = 115200
build_flags = 
    -D SERIAL_DEBUG=1
    -D TEST_MODE=1
build_src_filter = -<*> +<../examples/component_tests/SimplePositionTest.cpp> +<hardware/HardwareManager.cpp> +<hardware/MPU9250Interface.cpp> +<hardware/LEDInterface.cpp> +<hardware/PowerManager.cpp> +<detection/PositionDetector.cpp> +<core/Config.cpp> +<utils/DebugTools.cpp>
lib_deps = 
    fastled/FastLED @ ^3.5.0
    adafruit/Adafruit MPU6050 @ ^2.2.4
    adafruit/Adafruit Unified Sensor @ ^1.1.9
    adafruit/Adafruit BusIO @ ^1.14.1
    SPI
    Wire

; Position Detector Test environment - ACTIVE
; Used for testing the position detection system in isolation
[env:postest]
platform = espressif32
board = esp32dev
framework = arduino
upload_port = COM7
monitor_port = COM7
monitor_speed = 115200
build_flags = 
    -D SERIAL_DEBUG=1
    -D TEST_MODE=1
build_src_filter = -<*> +<../examples/component_tests/PositionDetectorTest.cpp> +<hardware/HardwareManager.cpp> +<hardware/MPU9250Interface.cpp> +<hardware/LEDInterface.cpp> +<hardware/PowerManager.cpp> +<detection/PositionDetector.cpp> +<core/Config.cpp> +<utils/DebugTools.cpp>
lib_deps = 
    fastled/FastLED @ ^3.5.0
    adafruit/Adafruit MPU6050 @ ^2.2.4
    adafruit/Adafruit Unified Sensor @ ^1.1.9
    adafruit/Adafruit BusIO @ ^1.14.1
    SPI
    Wire

; Calibration Protocol environment - ACTIVE
; Used when calibration of position thresholds is needed
[env:calibration]
platform = espressif32
board = esp32dev
framework = arduino
upload_port = COM7
monitor_port = COM7
monitor_speed = 115200
build_flags = 
    -D SERIAL_DEBUG=1
    -D SUPPRESS_LED_DEBUG=1
    -D CALIBRATION_MODE=1
build_src_filter = -<*> +<../examples/CalibrationProtocol.cpp> +<hardware/HardwareManager.cpp> +<hardware/MPU9250Interface.cpp> +<hardware/LEDInterface.cpp> +<hardware/PowerManager.cpp> +<core/Config.cpp> +<utils/DebugTools.cpp>
lib_deps = 
    fastled/FastLED @ ^3.5.0
    adafruit/Adafruit MPU6050 @ ^2.2.4
    adafruit/Adafruit Unified Sensor @ ^1.1.9
    adafruit/Adafruit BusIO @ ^1.14.1
    SPI
    Wire

; Hardware Manager Test environment - ACTIVE
; Used to verify the integration of hardware components
[env:hwmtest]
platform = espressif32
board = esp32dev
framework = arduino
upload_port = COM7
monitor_port = COM7
monitor_speed = 115200
build_flags = 
    -D SERIAL_DEBUG=1
    -D TEST_MODE=1
build_src_filter = -<*> +<../examples/HardwareManagerTest.cpp> +<hardware/HardwareManager.cpp> +<hardware/MPU9250Interface.cpp> +<hardware/LEDInterface.cpp> +<hardware/PowerManager.cpp> +<core/Config.cpp> +<utils/DebugTools.cpp>
lib_deps =
    fastled/FastLED @ ^3.5.0
    adafruit/Adafruit MPU6050 @ ^2.2.4
    Wire

; Ultra Basic Position Detection Test environment - ACTIVE
; Used for testing the UBPD system with physical unit thresholds
[env:ultrabasic]
platform = espressif32
board = esp32dev
framework = arduino
upload_port = COM7
monitor_port = COM7
monitor_speed = 115200
build_flags = 
    -D SERIAL_DEBUG=1
    -D TEST_MODE=1
build_src_filter = -<*> +<../examples/component_tests/UltraBasicPositionTest.cpp> +<hardware/HardwareManager.cpp> +<hardware/MPU9250Interface.cpp> +<hardware/LEDInterface.cpp> +<hardware/PowerManager.cpp> +<detection/UltraBasicPositionDetector.cpp> +<core/Config.cpp> +<utils/DebugTools.cpp>
lib_deps = 
    fastled/FastLED @ ^3.5.0
    adafruit/Adafruit MPU6050 @ ^2.2.4
    adafruit/Adafruit Unified Sensor @ ^1.1.9
    adafruit/Adafruit BusIO @ ^1.14.1
    SPI
    Wire

;====================================================================
; ARCHIVED TESTING ENVIRONMENTS - Commented out for reference
;====================================================================
; NOTE: These environments are preserved for reference but are no longer actively used
; To use any of these environments, uncomment the section and run with:
; pio run -e [environment_name]

; LED Test environment - ARCHIVED
;[env:ledtest]
;platform = espressif32
;board = esp32dev
;framework = arduino
;upload_port = COM7
;monitor_port = COM7
;monitor_speed = 115200
;build_src_filter = -<*> +<../examples/LEDTest.cpp> +<hardware/LEDInterface.cpp> +<core/Config.cpp> +<utils/DebugTools.cpp>
;lib_deps =
;    fastled/FastLED @ ^3.5.0
;    Wire

; MPU Diagnostic Test environment - ARCHIVED
;[env:mpudiag]
;platform = espressif32
;board = esp32dev
;framework = arduino
;upload_port = COM7
;monitor_port = COM7
;monitor_speed = 115200
;build_src_filter = -<*> +<../examples/MPUDiagnosticTest.cpp>
;lib_deps =
;    adafruit/Adafruit MPU6050 @ ^2.2.4
;    Wire

; MPU Unit Test environment - ARCHIVED
;[env:mputest]
;platform = espressif32
;board = esp32dev
;framework = arduino
;upload_port = COM7
;monitor_port = COM7
;monitor_speed = 115200
;build_src_filter = -<*> +<../test/mpu/MPU9250Test.cpp> +<../test/mpu/MPU9250TestMain.cpp> +<hardware/MPU9250Interface.cpp> +<utils/DebugTools.cpp>
;lib_deps =
;    adafruit/Adafruit MPU6050 @ ^2.2.4
;    Wire

; MPU Filter Test environment - ARCHIVED
;[env:mpufilter]
;platform = espressif32
;board = esp32dev
;framework = arduino
;upload_port = COM7
;monitor_port = COM7
;monitor_speed = 115200
;build_src_filter = -<*> +<../examples/MPUFilterTest.cpp> +<hardware/MPU9250Interface.cpp> +<utils/DebugTools.cpp> +<core/Config.cpp>
;lib_deps =
;    adafruit/Adafruit MPU6050 @ ^2.2.4
;    Wire
